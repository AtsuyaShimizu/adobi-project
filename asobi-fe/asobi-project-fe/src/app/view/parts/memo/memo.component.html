<div class="memo-content" aria-label="付箋メモ">
  <div class="memo-pin" aria-hidden="true"></div>
  <div class="toolbox" (mousedown)="$event.stopPropagation()">
    <!-- main buttons (hidden on narrow via container query) -->
    <button class="icon-button edit-btn" (click)="onEditButton($event)" title="編集">
      <svg viewBox="0 0 24 24" class="icon" aria-hidden="true"><path fill="currentColor" d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zm2.92 2.33H5v-.92l8.06-8.06.92.92-8.06 8.06zM20.71 7.04a1 1 0 0 0 0-1.41l-2.34-2.34a1 1 0 0 0-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"/></svg>
    </button>
    <button class="icon-button delete-btn" (click)="onDeleteButton($event)" title="削除">
      <svg viewBox="0 0 24 24" class="icon" aria-hidden="true"><path d="M6 6 L18 18 M6 18 L18 6" stroke="currentColor" stroke-width="2" stroke-linecap="round" fill="none"/></svg>
    </button>
    <button class="icon-button image-btn" (click)="onAddImageClick($event)" title="画像を追加">
      <svg viewBox="0 0 24 24" class="icon" aria-hidden="true">
        <rect x="4" y="6" width="16" height="12" rx="2" ry="2" stroke="currentColor" stroke-width="2" fill="none"/>
        <circle cx="9" cy="10" r="2" fill="currentColor"/>
        <path d="M21 16l-4.5-4.5-3.5 3.5-2-2L7 18" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"/>
      </svg>
    </button>

    <!-- collapsed menu trigger (hidden on wide; visible on narrow via container query) -->
    <button class="icon-button more-button" (click)="toggleMenu($event)" title="その他">
      <svg viewBox="0 0 24 24" class="icon" aria-hidden="true"><circle cx="5" cy="12" r="2"/><circle cx="12" cy="12" r="2"/><circle cx="19" cy="12" r="2"/></svg>
    </button>
    <div class="more-menu" [class.open]="menuOpen">
      <button (click)="onEditButton($event)">編集</button>
      <button (click)="onDeleteButton($event)">削除</button>
      <button (click)="onAddImageClick($event)">画像</button>
    </div>

    <input #fileInput type="file" accept="image/*" class="hidden-input" (change)="onImageSelect($event)" />
  </div>

  <div #memoBody class="memo-body" [attr.contenteditable]="editing ? 'true' : null" (blur)="onBlur($event)" [innerHTML]="memo.contentHtml || memo.text"></div>
  <div class="resize-handle" (mousedown)="onResizeMouseDown($event)" aria-label="サイズ変更"></div>
  <div class="focus-ring" aria-hidden="true"></div>
</div>
